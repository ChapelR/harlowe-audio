!function(){"use strict";var t=function(t,e){if(window.localStorage)try{t=""+t,"string"!=typeof e&&(e=JSON.stringify(e)),window.localStorage.setItem(t,e)}catch(t){console.error(t)}},e=function(t){if(window.localStorage)try{return t=""+t,window.localStorage.getItem(t)}catch(t){console.error(t)}},o=function(t){if(window.localStorage)try{t=""+t,window.localStorage.removeItem(t)}catch(t){console.error(t)}},r={classes:{},master:{volume:options.startingVol,mute:!1},groups:{playing:[],looping:[],custom:{}},mute:function(t){r.master.mute=!!t,$(document).trigger({type:":master-mute",mute:!!t})},isMuted:function(){return!!r.master.mute},volume:function(t){t=Number(t),Number.isNaN(t)||(1<t?t=1:t<0&&(t=0),r.master.volume=t),$(document).trigger({type:":master-volume",volume:t})},getVolume:function(){return r.master.volume},stopAll:function(){a.list.forEach(function(t){t.stop()})},audioPlaying:function(){return!!r.groups.playing.length},savePrefs:function(){t(options.storagekey,r.master)},loadPrefs:function(){var t=e(options.storagekey);t&&"object"==typeof t&&t.hasOwnProperty("volume")&&"number"==typeof t.volume&&t.hasOwnProperty("mute")&&"boolean"==typeof t.volume&&(delete r.master,r.master=t)},clearPrefs:function(){o(options.storagekey)}},u={aac:"audio/aac",caf:"audio/x-caf","x-caf":"audio/x-caf",mp3:'audio/mpeg; codecs="mp3"',mpeg:'audio/mpeg; codecs="mp3"',m4a:"audio/mp4",mp4:"audio/mp4","x-m4a":"audio/mp4","x-mp4":"audio/mp4",oga:"audio/ogg",ogg:"audio/ogg",opus:'audio/ogg; codecs="opus"',wav:"audio/wav",wave:"audio/wav",weba:"audio/webm",webm:"audio/webm"};function s(t){throw new Error(t)}function a(t,e,o){this instanceof a||s("Track: called without `new` operator"),t||s("Track: no id specified"),"string"!=typeof t&&s("Track: track id is not a string"),(!e||Array.isArray(e)&&!e.length)&&s("Track: no sources specified"),o&&(e=[].slice.call(arguments).slice(1));var i=$(document.createElement("audio"));e.forEach(function(t){var e,o,n;$(document.createElement("source")).attr({src:t,type:(e=t,o=e.split("."),n=o[o.length-1],n.includes("?")&&(n=n.split("?")[0]),n=n.toLowerCase().trim(),Object.keys(u).includes(n)||s('Track: unsupported file type "'+n+'"'),u[n])}).appendTo(i)}),i.attr({"data-track":"id","data-volume":1,"data-mute":!1}),options.preload&&i.attr("preload","auto"),i[0].volume=1*r.master.volume,this.id=t,this.$el=i,this.unwrap=i[0],this.sources=e}function n(t,e){if(!(this instanceof n))return new n(t,e);this.id=t,this.tracks=e.map(function(t){return a.get(t)}),this.loop=!1,this.current=""}a.list=[],a.is=function(t){return this instanceof a},a.has=function(e){return a.list.some(function(t){return t.id===e})},a.emit=function(t,e){$(document).trigger({type:t,track:e}),e.emit(t)},a.add=function(t){var e=new a(t,[].slice.call(arguments).slice(1));return a.list.push(e),e.$el.on("canplay",function(){a.emit(":available",e)}),e.$el.on("canplaythrough",function(){a.emit(":loaded",e)}),e},a.renew=function(){a.list.forEach(function(t){t.mute(t.isMuted()),t.volume(t.getVolume())})},a.getIdx=function(e){return a.list.findIndex(function(t){return t.id===e})},a.get=function(e){return a.list.find(function(t){return t.id===e})},a.prototype={constructor:a,emit:function(t){this.$el.trigger({type:t,track:this})},clone:function(){return new a(this.id,this.sources)},attach:function(){return this.$audio.appendTo(document.body),this},unattach:function(){return this.$audio.remove(),this},isPlaying:function(){return!this.unwrap.paused},play:function(){var t=this;return this.unwrap.play(),a.emit(":play",this),this.$el.on("ended",function(){t.unwrap.loop||(t.unwrap.currentTime=0,a.emit(":stop",t))}),this},playWhenPossible:function(){var e=this;return this.unwrap.play().then(function(){a.emit(":play",e),e.$el.on("ended",function(){e.unwrap.loop||(e.unwrap.currentTime=0,a.emit(":stop",e))})},function(t){$(document).one("click mousedown keydown touchstart",function(){e.play()})}).catch(function(t){console.error(t)}),this},forcePlay:function(){var t=this,e=$(document.createElement("a")).css("display","none").appendTo(document.body).on("click",function(){t.play()});setTimeout(function(){e.trigger("click")},100)},pause:function(){return this.unwrap.pause(),a.emit(":pause",this),this},stop:function(){return this.unwrap.pause(),this.unwrap.currentTime=0,a.emit(":stop",this),this},mute:function(t){return t=!!t,r.master.mute!==t?(this.$el.attr("data-mute",t),this.unwrap.muted=!!r.master.mute):(this.$el.attr("data-mute",t),this.unwrap.muted=t),a.emit(":mute",this),this},isMuted:function(){var t=this.$el.attr("data-mute");return"boolean"==typeof t?t:"false"!==t},toggleMute:function(){return this.mute(!this.isMuted()),this},volume:function(t){return t=Number(t),Number.isNaN(t)||(1<t?t=1:t<0&&(t=0),this.$el.attr("data-volume",t),this.unwrap.volume=t*r.master.volume),a.emit(":volume",this),this},getVolume:function(){return Number(this.$el.attr("data-volume"))},addToGroup:function(t,e){return(e?r.groups.custom[t]:r.groups[t]).push(this),this},removeFromGroup:function(t,e){var o=this,n=e?r.groups.custom[t]:r.groups[t],i=n.findIndex(function(t){return t.id&&t.id===o.id});return n.splice(i,1),this},loop:function(t){return this.unwrap.loop=!!t,this.unwrap.loop?this.addToGroup("looping"):this.removeFromGroup("looping"),this},isLooping:function(){return!!this.unwrap.loop},toggleLoop:function(){return this.loop(!this.isLooping()),this},seek:function(t){return t<0?t=this.unwrap.duration-t:t>this.unwrap.duration&&(t=this.unwrap.duration),this.unwrap.currentTime=t,this},fadeIn:function(t){var e=this;t=t||1;var o=this.getVolume();return this.volume(0),this.play(),this.$el.animate({volume:o*r.master.volume},1e3*t,function(){e.volume(o),a.emit(":volume",e),a.emit(":fade",e)}),this},fadeOut:function(t){t=t||1;var e=this,o=this.getVolume();return this.$el.animate({volume:0},1e3*t,function(){e.stop(),e.volume(o),a.emit(":volume",e),a.emit(":fade",e)}),this},fadeTo:function(t,e){t=t||1;this.getVolume();return e=Number(e),Number.isNaN(e)||(1<e?e=1:e<0&&(e=0)),this.volume(0),this.$el.animate({volume:target*r.master.volume},1e3*t,function(){a.emit(":volume",self),a.emit(":fade",self)}),this},delay:function(t,e){var o=this;"function"==typeof e&&(t=Number(t),(Number.isNaN(t)||t<0)&&(t=0),setTimeout(function(){e.call(o,o,t)},t))}},$(document).on(":master-mute",a.renew),$(document).on(":master-volume",a.renew),options.persistPrefs&&($(document).on(":master-mute",r.savePrefs),$(document).on(":master-volume",r.savePrefs)),$(document).on(":play",function(t){t.track.addToGroup("playing")}),$(document).on(":stop",function(t){t.track.removeFromGroup("playing")}),options.muteOnBlur&&$(window).on("blur",function(){r.isMuted()||(r.mute(!0),$(window).one("focus",function(){r.mute(!1)}))}),r.classes.Track=a,r.newTrack=a.add,r.track=function(t){return a.get(t)},r.createGroup=function(t,e,o){var n,i,u;n=o?[].slice.call(arguments).slice(1):e,i=t,(u=n)&&Array.isArray(u)||(u=[]),r.groups.custom[i]=u.map(function(t){return a.get(t)})},r.group=function(t){if(!(this instanceof r.group))return new r.group(t);Object.keys(r.groups.custom).includes(t)?Object.assign(this,r.groups.custom[t]):Object.assign(this,r.groups[t]||null)},r.group.is=function(t){return this instanceof r.group},r.group.runOnAll=function(t,e,o){r.group.is(t)&&t.forEach(function(t){a.is(t)&&t[e].call(t,o&&Array.isArray(o)?o:[])})},r.group.prototype={constructor:r.group,run:function(t,e,o){null!=o&&(e=[].slice.call(arguments).slice(1)),a.prototype.hasOwnProperty(t)&&r.group.runOnAll(this,t,e)},play:function(){return this.run("play"),this},pause:function(){return this.run("pause"),this},stop:function(){return this.run("stop"),this},mute:function(t){return this.run("mute",[t]),this},volume:function(t){return this.run("volume",[t]),this},loop:function(t){return this.run("loop",[t]),this}},n.list={},n.is=function(t){return t instanceof n},n.add=function(t,e,o){return o&&(e=[].slice.call(arguments).slice(1)),n.list[t]=new n(t,e),n.list[t]},n.prototype={constructor:n,clone:function(){return new n(this.id,this.tracks.map(function(t){return t.id}))},shuffle:function(){var t,e,o,n=this.tracks;for(o=n.length-1;0<o;o--)t=Math.floor(Math.random()*(o+1)),e=n[o],n[o]=n[t],n[t]=e;return this.tracks=n,this},random:function(){return this.tracks[Math.floor(Math.random()*this.tracks.length)]},play:function(t){var e=e||function(){return this.current?this.tracks.findIndex(function(t){return t.id===this.current}):0}();if(e>=this.tracks.length&&this.loop){e=0;var o=this,n=this.tracks[e],i=n.isLooping();return n.loop(!1),t?n.forcePlay():n.play(),this.current=n.id,n.on("ended.playlist",function(){e++,n.loop(i),o.play()}),this}this.current=""},loop:function(t){return this.loop=!!t,this},stop:function(){return this.current.stop().off("ended.playlist"),this.current="",this},pause:function(){return this.current.pause(),this}},r.classes.Playlist=n,r.createPlaylist=n.add,r.playlist=function(t){return n.list[t]||null},window.Chapel=window.Chapel||{},window.Chapel.Audio=r,options.persistPrefs&&r.loadPrefs()}(),function(){"use strict";if(options.controls.show){var t=$(document.createElement("input")).attr({id:"audio-volume",type:"range",min:1,max:99,step:1}),e=Math.trunc(100*window.Chapel.Audio.master.volume);e<0?e=0:100<e&&(e=100),t.attr("value",e),t.on("input",function(){window.Chapel.Audio.volume($(this).val()/100)});var o=$(document.createElement("tw-link")).attr("id","audio-mute").append("Mute <span></span>").on("click",function(t){t.preventDefault(),$(this).toggleClass("muted"),Chapel.Audio.mute(!Chapel.Audio.isMuted())});Chapel.Audio.isMuted()&&o.addClass("muted");var n=$(document.createElement("tw-link")).attr("id","audio-panel-toggle").on("click",function(t){t.preventDefault(),i.toggleClass("closed")}),i=$(document.createElement("div")).attr("id","audio-controls").append(t,o,n).appendTo(document.body);options.controls.startClosed&&i.addClass("closed"),window.Chapel=window.Chapel||{},window.Chapel.Audio=window.Chapel.Audio||{},window.Chapel.Audio.controls={$panel:i,$volume:t,$mute:o,close:function(){i.addClass("closed")},open:function(){i.removeClass("closed")},toggle:function(){i.toggleClass("closed")},hide:function(){i.css("display","none")},show:function(){i.css("display","block")}}}}(),function(){"use strict";var t=$(document.createElement("div")).attr("id","audio-overlay").appendTo(document.body);function e(){t.css("display","block").append('<div class="lds-ring"><div></div><div></div><div></div><div></div></div>')}function i(){t.fadeOut(function(){t.empty()})}function o(){$(document).ready(function(){e()});var t=100+options.loadDelay;setTimeout(function(){var t=Chapel.Audio.classes.Track.list;if(t&&Array.isArray(t)&&t.length){var e,o=Chapel.Audio.classes.Track.list.map(function(t){return t.$el}),n=function(){o.length?((e=o.shift()).attr("preload","auto"),e.one("canplay.loadTrack",function(){$(this).off(".loadTrack"),n()})):i()};n()}},t)}options.preload&&o(),window.Chapel=window.Chapel||{},window.Chapel.Audio=window.Chapel.Audio||{},window.Chapel.Audio.loadScreen={show:e,dismiss:i},window.Chapel.Audio.$overlay=t,window.Chapel.Audio.preload=o}(),function(){"use strict";void 0===window.A&&(window.A=window.Chapel.Audio),$(document).on("unload",function(){A.savePrefs()})}();